= üîê Configuraci√≥n de Confluent Cloud (15 minutos)
Luis Chavez <lchavez.olaya@gmail.com>, ¬© 2025
2025-09-11
:revdate: 2025-09-11
:linkattrs:
:ast: &ast;
:y: &#10003;
:n: &#10008;
:y: icon:check-sign[role="green"]
:n: icon:check-minus[role="red"]
:c: icon:file-text-alt[role="blue"]
:toc: auto
:toc-placement: auto
:toc-position: auto
:toc-title: Contenido de la gu√≠a de configuraci√≥n
:toclevels: 3
:idprefix:
:idseparator: -
:sectanchors:
:icons: font
:source-highlighter: highlight.js
:highlightjs-theme: idea
:experimental:

Esta gu√≠a le guiar√° en la configuraci√≥n de su entorno de Confluent Cloud para el taller.

toc::[]

== üéØ Objetivos de aprendizaje

Al finalizar esta secci√≥n, habr√°s:

* ‚úÖ Validado que todas las herramientas prerrequisito est√©n instaladas
* ‚úÖ Autenticado con Confluent Cloud
* ‚úÖ Creado un cl√∫ster de Kafka funcional
* ‚úÖ Generado claves API para el acceso al cl√∫ster
* ‚úÖ Validado el acceso a Tableflow con las credenciales existentes

== ‚è±Ô∏è Asignaci√≥n de tiempo

* **Validaci√≥n de prerrequisitos**: 3 minutos
* **Autenticaci√≥n y configuraci√≥n del entorno**: 7 minutos
* **Creaci√≥n de cl√∫ster de Kafka**: 5 minutos
* **Validaci√≥n de Tableflow**: 2 minutos

== üîç Validaci√≥n de prerrequisitos (3 minutos)

=== Verificar la extensi√≥n Confluent de VSCode

Abrir VSCode

Vayan a Extensiones (Ctrl+Shift+X / Cmd+Shift+X)

Buscar "Confluent"

Verificar que la extensi√≥n Confluent est√© instalada y habilitada

[source,bash]
----
# Alternativa: Comprobar si la extensi√≥n est√° instalada mediante la CLI
code --list-extensions | grep confluent
----

=== Verificar la instalaci√≥n de la CLI de Confluent

[source,bash]
----
# Comprobar la instalaci√≥n y la versi√≥n de la CLI
confluent version

# El resultado esperado deber√≠a mostrar la versi√≥n 3.x o superior
# confluent - Confluent CLI
# Versi√≥n: v3.x.x
# Referencia de Git: xxxxxxx
# Fecha de compilaci√≥n: 2024-xx-xx
----

Si no est√° instalada, ejecutar:
[source,bash]
----
# Instalar la CLI de Confluent
curl -sL --http1.1 https://cnfl.io/cli | sh -s -- latest
----

=== Validar la instalaci√≥n de DuckDB

[source,bash]
----
# Verificar la instalaci√≥n de DuckDB
duckdb --version

# Salida esperada: v0.x.x o superior
----

Si no est√° instalado, visite: https://duckdb.org/docs/installation/

== üåç Autenticaci√≥n y configuraci√≥n del entorno (7 minutos)

=== Iniciar sesi√≥n en Confluent Cloud

[source,bash]
----
# Iniciar sesi√≥n en Confluent Cloud
confluent login --save

# Esto abrir√° su navegador para la autenticaci√≥n
# Complete el proceso de inicio de sesi√≥n en su navegador
----

=== Crear o seleccionar organizaci√≥n

[source,bash]
----
# Listar las organizaciones disponibles
confluent organization list
----

=== Crear el entorno del taller

[source,bash]
----
# Crear un nuevo entorno para el taller
confluent environment create "cc-workshop-env"

# Listar los entornos para ver su nuevo entorno
confluent environment list

# Usar el entorno del taller (reemplazar $CC_ENV_ID con el ID real)
# export CC_ENV_ID=<your-env-id>
confluent environment use $CC_ENV_ID
----

== ‚òÅÔ∏è Creaci√≥n de cl√∫ster de Kafka (5 minutos)

=== Crear Kafka b√°sico Cl√∫ster

[source,bash]
----
# Crear un cl√∫ster b√°sico (ideal para desarrollo/taller)
confluent kafka cluster create workshop-cluster \
--cloud aws \
--region us-east-1 \
--type basic
----

NOTA: Los cl√∫steres b√°sicos son gratuitos y perfectos para talleres.
Tienen algunas limitaciones, pero son suficientes para nuestro caso de uso.

=== Configurar los ajustes del cl√∫ster

[source,bash]
----
# Listar cl√∫steres para obtener el ID del cl√∫ster
confluent kafka cluster list

# Usar el cl√∫ster (reemplazar CLUSTER_ID con el ID real)
# export CC_KAFKA_CLUSTER=<your-cluster-id>
confluent kafka cluster use $CC_KAFKA_CLUSTER

# Describir el cl√∫ster para verificar la configuraci√≥n
confluent kafka cluster describe $CC_KAFKA_CLUSTER
----

=== Generar claves API

==== Claves API del cl√∫ster de Kafka

[source,bash]
----
# Crear clave API para el acceso al cl√∫ster
confluent api-key create --resource $CC_KAFKA_CLUSTER --description "Clave API del taller para el cl√∫ster de Kafka"

# Almacenar la clave API y el secreto; los necesitar√° m√°s adelante
# Clave API: <your-kafka-api-key>
# Secreto API: <your-kafka-api-secret>

# Usar la clave API
# export KAFKA_API_KEY=<your-kafka-api-key>
# export KAFKA_API_SECRET=<your-kafka-api-secret>
confluent api-key use $KAFKA_API_KEY --resource $CC_KAFKA_CLUSTER
----

==== API del registro de esquemas Claves

[source,bash]
----
# Obtener el ID del cl√∫ster del Registro de Esquemas
confluent schema-registry cluster describe

# Crear la clave API para acceder al Registro de Esquemas
# export SCHEMA_REGISTRY_CLUSTER_ID=<your-sr-cluster-id>
confluent api-key create --resource $SCHEMA_REGISTRY_CLUSTER_ID --description "Clave API de taller para el Registro de Esquemas"

# Almacenar la clave API y el secreto del Registro de Esquemas
# Clave API del Registro de Esquemas: <your-sr-api-key>
# Secreto API del Registro de Esquemas: <your-sr-api-secret>

# Usar la clave API del Registro de Esquemas
# export SCHEMA_REGISTRY_API_KEY=<your-sr-api-key>
# export SCHEMA_REGISTRY_API_SECRET=<your-sr-api-secret>
----

==== API de Tableflow Claves

[source,bash]
----
# Crear clave API para acceder a Tableflow
confluent api-key create --resource tableflow --description "Clave API de taller para Tableflow"

# Almacenar la clave API y el secreto de Tableflow
# Clave API de Tableflow: <your-tableflow-api-key>
# Secreto API de Tableflow: <your-tableflow-api-secret>

# Usar la clave API de Tableflow
# export TABLEFLOW_API_KEY=<your-tableflow-api-key>
# export TABLEFLOW_API_SECRET=<your-tableflow-api-secret>

# Probar el acceso a Tableflow listando los temas (inicialmente debe estar vac√≠o)
confluent tableflow topic list
----

==== Almacenar claves API en el archivo de entorno

[source,bash]
----
# Acceder al directorio de scripts
cd ./scripts/kafka

# Copiar el archivo de entorno de ejemplo
cp .env.example .env

# Edita el archivo .env con tus claves de API:
# export KAFKA_API_KEY="tu-clave-de-API-de-kafka"
# export KAFKA_API_SECRET="tu-secreto-de-API-de-kafka"
# export SCHEMA_REGISTRY_API_KEY="tu-clave-de-API-de-sr"
# export SCHEMA_REGISTRY_API_SECRET="tu-secreto-de-api-de-sr"
# export TABLEFLOW_API_KEY="tu-clave-de-API-de-tableflow"
# export TABLEFLOW_API_SECRET="tu-secreto-de-api-de-tableflow"

# Carga las variables de entorno
source .env
----

=== Validar la conectividad del cl√∫ster

[source,bash]
----
# Probar la conectividad del cl√∫ster listando los temas (inicialmente debe estar vac√≠o)
confluent kafka topic Lista

# Si la operaci√≥n es correcta, deber√≠a ver una lista vac√≠a o temas del sistema.
----

== ‚úÖ Lista de verificaci√≥n de validaci√≥n

Antes de continuar con la siguiente secci√≥n, aseg√∫rese de lo siguiente:

- [ ] La extensi√≥n VSCode Confluent est√° instalada y funcionando.
- [ ] La CLI de Confluent est√° instalada (versi√≥n 3.x+).
- [ ] DuckDB est√° instalado y accesible.
- [ ] Se ha iniciado sesi√≥n correctamente en Confluent Cloud.
- [ ] Entorno de taller creado y activo.
- [ ] Cl√∫ster b√°sico de Kafka creado y en ejecuci√≥n.
- [ ] Claves de API del cl√∫ster de Kafka generadas y configuradas.
- [ ] Claves de API del registro de esquema generadas y configuradas.
- [ ] Claves de API de Tableflow generadas y configuradas.
- [ ] Claves de API almacenadas en el archivo `.env` del directorio `scripts/kafka/`.
- [ ] Conectividad del cl√∫ster validada.

== üîß Entregables clave

Al final de esta secci√≥n, deber√≠a tener:

* **Entorno de Confluent Cloud en funcionamiento** con la autenticaci√≥n adecuada.
* **Sesi√≥n CLI autenticada** con contexto guardado
* **Cl√∫ster b√°sico de Kafka** listo para la creaci√≥n de temas y la transmisi√≥n de datos
* **Claves API configuradas** para acceso program√°tico

== üö® Soluci√≥n de problemas

=== Problemas comunes

**Problemas de inicio de sesi√≥n en la CLI**:
Si el navegador no se abre autom√°ticamente:
[source,bash]
----
# Intentar iniciar sesi√≥n manualmente con el indicador --no-browser
confluent login --save --no-browser
# Seguir la URL proporcionada manualmente
----

**Fallo al crear el cl√∫ster**:
Comprobar los l√≠mites de la cuenta:
[source,bash]
----
# Comprobar las cuotas de servicio
confluent service-quota list organization
----

**Problemas con las claves API**:
Si falla la creaci√≥n de la clave API:
[source,bash]
----
# Listar las claves API existentes
confluent api-key list
# Eliminar las claves no utilizadas si se alcanza el l√≠mite
confluent api-key Eliminar <key-id>
----

== üìö Recursos adicionales

* https://docs.confluent.io/confluent-cli/current/install.html[Gu√≠a de instalaci√≥n de Confluent CLI]
* https://docs.confluent.io/cloud/current/get-started/index.html[Introducci√≥n a Confluent Cloud]
* https://docs.confluent.io/cloud/current/clusters/cluster-types.html[Tipos de cl√∫ster de Kafka]

---

**Siguiente**: Contin√∫e con el enlace: 02-kafka-hands-on.adoc[] para la gesti√≥n de temas de Kafka y la configuraci√≥n del conector HTTP.